# Copilot Instructions for chatai

## Архитектура и ключевые компоненты
  - `api/`: интеграция с внешними AI (например, `gemini.py`, `openrouterai.py`).
  - `config_data/`: конфигурация, токены, параметры запуска.
  - `handlers/`: обработчики Telegram-команд, разделены на `handlers_custom/` и `handlers_default/`.
  - `services/`: сервисные функции для работы с текстом (разделение, очистка и др.).

## Критические паттерны и конвенции

## Взаимодействие компонентов

## Запуск, тестирование и отладка

## Примеры специфических решений

## Внешние зависимости

## Рекомендации для AI-агентов

Если какие-либо разделы требуют примеров или доработки — сообщите!
# Copilot Instructions for chatai

## Архитектура и ключевые компоненты
- Проект — Telegram-бот с интеграцией внешних AI (Gemini, OpenRouterAI) и поддержкой длинных сообщений.
- Главный файл запуска: `main.py`.
- Ключевые директории:
  - `api/`: интеграция с внешними AI (`gemini.py`, `openrouterai.py`).
  - `config_data/`: конфигурация, токены, параметры запуска (`config.py`).
  - `handlers/`: обработчики Telegram-команд (`handlers_custom/`, `handlers_default/`).
  - `services/`: сервисные функции для работы с текстом (`text_cleaner.py`, `text_splitter.py`, `block_splitter.py`).

## Критические паттерны и конвенции
- Для отправки длинных сообщений используйте разбиение текста на части с лимитом ~3900 символов (см. `services/block_splitter.py`, `services/text_splitter.py`).
- Для передачи очень длинных текстов используйте отправку файла через `send_document` (пример: `test1.py`).
- Всегда оборачивайте вызовы Telegram API (`send_message`, `send_document`) в `try-except` для предотвращения падения бота.
- Все обработчики команд оформляйте через декоратор `@bot.message_handler` (`handlers_default/start.py`, `handlers_default/help.py`).
- Сервисные функции для работы с текстом вынесены в отдельные модули в `services/`.

## Взаимодействие компонентов
- Обработчики команд используют сервисы для подготовки текста и API-модули для обращения к внешним AI.
- Конфигурация токенов и параметров — в `config_data/config.py` и `.env_template`.

## Запуск, тестирование и отладка
- Запуск бота: `python main.py`
- Тестирование функций: `test0.py`, `test1.py`
- Все зависимости — в `requirements.txt`
- Для отладки используйте вывод ошибок в консоль и обработку исключений

## Примеры специфических решений
- Разделение длинных сообщений по параграфам и коду для сохранения структуры (`block_splitter.py`, `text_splitter.py`).
- Задержка между отправкой частей сообщения для обхода лимитов Telegram (`time.sleep(0.5)`).
- Отправка очень длинных текстов через файл (`send_document`).

## Внешние зависимости
- Основная библиотека для Telegram: `pyTelegramBotAPI` (telebot)
- Для интеграции с AI используйте соответствующие API-клиенты (`google-genai`, `requests`)

## Рекомендации для AI-агентов
- Новые обработчики команд размещайте в соответствующих подпапках `handlers/`
- Для работы с длинным текстом используйте сервисы из `services/`
- Следуйте структуре и паттернам, описанным в коде проекта


Если какие-либо разделы требуют примеров или доработки — сообщите!
